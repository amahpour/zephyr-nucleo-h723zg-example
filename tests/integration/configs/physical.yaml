# Physical test configuration (real hardware + Rigol DP832 + KB2040 mux)
#
# Usage: pytest tests/integration/ --config=tests/integration/configs/physical.yaml -v
#
# Requirements:
# - STM32 Nucleo board connected via USB
# - Rigol DP832 power supply connected via network
# - KB2040 mux controller connected via USB
# - Power supply CH3 output connected to mux common input (SIG)
# - Mux outputs Y0-Y14 connected to Nucleo ADC inputs per docs/hardware.md
#
# Channel Configuration:
# - 15 ADC channels (mux channels 0-14, board labels CH1-CH15)
# - Build firmware with: west build -b nucleo_h723zg app --pristine -- -DCONFIG_APP_NUM_CH=15
#
# See docs/hardware.md for complete wiring guide

dut:
  type: physical
  port: /dev/ttyACM0  # Nucleo ST-LINK serial (VID:0483 PID:374e STLINK-V3)
  baudrate: 115200

instrument:
  type: physical
  
  power_supply:
    visa_resource: "TCPIP::192.168.68.109::INSTR"  # Rigol DP832 power supply
    channel: 3  # Power supply channel to use
    current_limit: 0.1  # 100mA safety limit
  
  mux:
    port: /dev/ttyACM1  # KB2040 serial port (VID:239a PID:8105 Adafruit KB2040)
    baudrate: 115200

# Number of ADC channels available (15 channels: 0-14)
# Temporarily set to 6 for testing channels 0-5 only
num_channels: 6

tests:
  - test_read_initial_registers
  - test_inject_and_read_single_channel
  - test_inject_and_read_multiple_channels
  - test_sequence_increment
  - test_voltage_range_low
  - test_voltage_range_high
